Original Code from @biosfood , added Integrals to the calculation
